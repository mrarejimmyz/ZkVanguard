# Cloudflare Tunnel Configuration for ZK-STARK API
# =================================================
# This config routes traffic from your Cloudflare domain to the local ZK API
#
# Usage:
#   1. Replace TUNNEL_ID with your actual tunnel ID
#   2. Replace zk-api.yourdomain.com with your domain
#   3. Copy to ~/.cloudflared/config.yml
#   4. Run: cloudflared tunnel run zk-stark-api

tunnel: TUNNEL_ID_HERE
credentials-file: ~/.cloudflared/TUNNEL_ID_HERE.json

# Ingress rules - routes requests to services
ingress:
  # Main ZK-STARK API endpoint
  - hostname: zk-api.yourdomain.com
    service: http://localhost:8000
    originRequest:
      # Connection settings
      connectTimeout: 30s
      noTLSVerify: false
      # Keep connections alive for proof generation
      keepAliveTimeout: 120s
      keepAliveConnections: 100
      # HTTP/2 for better performance
      http2Origin: true

  # WebSocket support (if needed for real-time proof status)
  - hostname: zk-ws.yourdomain.com
    service: ws://localhost:8000
    originRequest:
      connectTimeout: 30s

  # Health check endpoint
  - hostname: zk-health.yourdomain.com
    service: http://localhost:8000/health

  # API docs (Swagger/OpenAPI)
  - hostname: zk-docs.yourdomain.com
    service: http://localhost:8000/docs

  # Catch-all rule (required by Cloudflare)
  - service: http_status:404
